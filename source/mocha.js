"use strict";var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");Object.defineProperty(exports, "__esModule", { value: true });exports.runMocha = runMocha;var _mocha = _interopRequireDefault(require("mocha"));
var _javascriptTranspilation = require("@deployment/javascriptTranspilation");
var _script = require("./script.js");


function runMocha({
  mocha,
  testTarget,
  jsFileArray,
  shouldInvalidateRequireModule = false,
  shouldCompileTest = true,
  shouldDebugger,
  targetProject,
  mochaOption = {},
  additionalParameter } =
{}) {

  mochaOption = Object.assign(
  {
    ui: 'tdd',
    reporter: 'progress' || 'min',
    timeout: 10000,
    fullTrace: true },



  mochaOption);


  if (shouldDebugger) mochaOption.timeout = Infinity;
  mocha || (mocha = new _mocha.default(mochaOption));

  if (shouldInvalidateRequireModule) {
    const { invalidateRequiredModule, invalidateRequiredModuleEventHandler } = '../utility/invalidateRequiredModule.js';
    invalidateRequiredModuleEventHandler({ mochaInstance: mocha });
    invalidateRequiredModule({ fileArray: jsFileArray });
  }

  if (shouldCompileTest) {
    let compiler = new _javascriptTranspilation.Compiler({ babelConfig: targetProject.configuration.getTranspilation().babelConfig });
    compiler.requireHook({ restrictToTargetProject: false });





  }


  if (Array.isArray(testTarget)) {

    testTarget.forEach(file => {
      mocha.addFile(file);
    });
  } else {

    mocha.addFile(testPath);
  }


  if (additionalParameter)
  global.additionalParameter = JSON.stringify(additionalParameter);



  try {
    if (shouldDebugger) {
      (0, _script.subprocessInspector)();

    }
    mocha.run(error => {

      if (error) {


      }

    });


















  } catch (error) {
    console.group(`âš  Error while running Mocha test:`);
    console.log(error);
    console.groupEnd();
    console.log('\n');

  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NvdXJjZS9tb2NoYS5qcyJdLCJuYW1lcyI6WyJydW5Nb2NoYSIsIm1vY2hhIiwidGVzdFRhcmdldCIsImpzRmlsZUFycmF5Iiwic2hvdWxkSW52YWxpZGF0ZVJlcXVpcmVNb2R1bGUiLCJzaG91bGRDb21waWxlVGVzdCIsInNob3VsZERlYnVnZ2VyIiwidGFyZ2V0UHJvamVjdCIsIm1vY2hhT3B0aW9uIiwiYWRkaXRpb25hbFBhcmFtZXRlciIsIk9iamVjdCIsImFzc2lnbiIsInVpIiwicmVwb3J0ZXIiLCJ0aW1lb3V0IiwiZnVsbFRyYWNlIiwiSW5maW5pdHkiLCJNb2NoYSIsImludmFsaWRhdGVSZXF1aXJlZE1vZHVsZSIsImludmFsaWRhdGVSZXF1aXJlZE1vZHVsZUV2ZW50SGFuZGxlciIsIm1vY2hhSW5zdGFuY2UiLCJmaWxlQXJyYXkiLCJjb21waWxlciIsIkNvbXBpbGVyIiwiYmFiZWxDb25maWciLCJjb25maWd1cmF0aW9uIiwiZ2V0VHJhbnNwaWxhdGlvbiIsInJlcXVpcmVIb29rIiwicmVzdHJpY3RUb1RhcmdldFByb2plY3QiLCJBcnJheSIsImlzQXJyYXkiLCJmb3JFYWNoIiwiZmlsZSIsImFkZEZpbGUiLCJ0ZXN0UGF0aCIsImdsb2JhbCIsIkpTT04iLCJzdHJpbmdpZnkiLCJydW4iLCJlcnJvciIsImNvbnNvbGUiLCJncm91cCIsImxvZyIsImdyb3VwRW5kIl0sIm1hcHBpbmdzIjoiNExBQUE7QUFDQTtBQUNBOzs7QUFHTyxTQUFTQSxRQUFULENBQWtCO0FBQ3ZCQyxFQUFBQSxLQUR1QjtBQUV2QkMsRUFBQUEsVUFGdUI7QUFHdkJDLEVBQUFBLFdBSHVCO0FBSXZCQyxFQUFBQSw2QkFBNkIsR0FBRyxLQUpUO0FBS3ZCQyxFQUFBQSxpQkFBaUIsR0FBRyxJQUxHO0FBTXZCQyxFQUFBQSxjQU51QjtBQU92QkMsRUFBQUEsYUFQdUI7QUFRdkJDLEVBQUFBLFdBQVcsR0FBRyxFQVJTO0FBU3ZCQyxFQUFBQSxtQkFUdUI7QUFVckIsRUFWRyxFQVVDOztBQUVORCxFQUFBQSxXQUFXLEdBQUdFLE1BQU0sQ0FBQ0MsTUFBUDtBQUNaO0FBQ0VDLElBQUFBLEVBQUUsRUFBRSxLQUROO0FBRUVDLElBQUFBLFFBQVEsRUFBRSxjQUFjLEtBRjFCO0FBR0VDLElBQUFBLE9BQU8sRUFBRSxLQUhYO0FBSUVDLElBQUFBLFNBQVMsRUFBRSxJQUpiLEVBRFk7Ozs7QUFTWlAsRUFBQUEsV0FUWSxDQUFkOzs7QUFZQSxNQUFJRixjQUFKLEVBQW9CRSxXQUFXLENBQUNNLE9BQVosR0FBc0JFLFFBQXRCO0FBQ3BCZixFQUFBQSxLQUFLLEtBQUxBLEtBQUssR0FBSyxJQUFJZ0IsY0FBSixDQUFVVCxXQUFWLENBQUwsQ0FBTDs7QUFFQSxNQUFJSiw2QkFBSixFQUFtQztBQUNqQyxVQUFNLEVBQUVjLHdCQUFGLEVBQTRCQyxvQ0FBNUIsS0FBcUUsd0NBQTNFO0FBQ0FBLElBQUFBLG9DQUFvQyxDQUFDLEVBQUVDLGFBQWEsRUFBRW5CLEtBQWpCLEVBQUQsQ0FBcEM7QUFDQWlCLElBQUFBLHdCQUF3QixDQUFDLEVBQUVHLFNBQVMsRUFBRWxCLFdBQWIsRUFBRCxDQUF4QjtBQUNEOztBQUVELE1BQUlFLGlCQUFKLEVBQXVCO0FBQ3JCLFFBQUlpQixRQUFRLEdBQUcsSUFBSUMsaUNBQUosQ0FBYSxFQUFFQyxXQUFXLEVBQUVqQixhQUFhLENBQUNrQixhQUFkLENBQTRCQyxnQkFBNUIsR0FBK0NGLFdBQTlELEVBQWIsQ0FBZjtBQUNBRixJQUFBQSxRQUFRLENBQUNLLFdBQVQsQ0FBcUIsRUFBRUMsdUJBQXVCLEVBQUUsS0FBM0IsRUFBckI7Ozs7OztBQU1EOzs7QUFHRCxNQUFJQyxLQUFLLENBQUNDLE9BQU4sQ0FBYzVCLFVBQWQsQ0FBSixFQUErQjs7QUFFN0JBLElBQUFBLFVBQVUsQ0FBQzZCLE9BQVgsQ0FBbUJDLElBQUksSUFBSTtBQUN6Qi9CLE1BQUFBLEtBQUssQ0FBQ2dDLE9BQU4sQ0FBY0QsSUFBZDtBQUNELEtBRkQ7QUFHRCxHQUxELE1BS087O0FBRUwvQixJQUFBQSxLQUFLLENBQUNnQyxPQUFOLENBQWNDLFFBQWQ7QUFDRDs7O0FBR0QsTUFBSXpCLG1CQUFKO0FBQ0UwQixFQUFBQSxNQUFNLENBQUMxQixtQkFBUCxHQUE2QjJCLElBQUksQ0FBQ0MsU0FBTCxDQUFlNUIsbUJBQWYsQ0FBN0I7Ozs7QUFJRixNQUFJO0FBQ0YsUUFBSUgsY0FBSixFQUFvQjtBQUNsQjs7QUFFRDtBQUNETCxJQUFBQSxLQUFLLENBQUNxQyxHQUFOLENBQVVDLEtBQUssSUFBSTs7QUFFakIsVUFBSUEsS0FBSixFQUFXOzs7QUFHVjs7QUFFRixLQVBEOzs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMEJELEdBL0JELENBK0JFLE9BQU9BLEtBQVAsRUFBYztBQUNkQyxJQUFBQSxPQUFPLENBQUNDLEtBQVIsQ0FBZSxtQ0FBZjtBQUNBRCxJQUFBQSxPQUFPLENBQUNFLEdBQVIsQ0FBWUgsS0FBWjtBQUNBQyxJQUFBQSxPQUFPLENBQUNHLFFBQVI7QUFDQUgsSUFBQUEsT0FBTyxDQUFDRSxHQUFSLENBQVksSUFBWjs7QUFFRDtBQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IE1vY2hhIGZyb20gJ21vY2hhJyAvLyBNb2NoYSAtUHJvZ3JhbW1hdGljIHJlc3QgcnVubmVyIGh0dHBzOi8vZ2l0aHViLmNvbS9tb2NoYWpzL21vY2hhL3dpa2kvVXNpbmctbW9jaGEtcHJvZ3JhbW1hdGljYWxseVxuaW1wb3J0IHsgQ29tcGlsZXIgfSBmcm9tICdAZGVwbG95bWVudC9qYXZhc2NyaXB0VHJhbnNwaWxhdGlvbidcbmltcG9ydCB7IHN1YnByb2Nlc3NJbnNwZWN0b3IgfSBmcm9tICcuL3NjcmlwdC5qcydcblxuLy8gTW9jaGEgcHJvZ3JhbW1hdGljIGFwaSBodHRwczovL21vY2hhanMub3JnL2FwaS9cbmV4cG9ydCBmdW5jdGlvbiBydW5Nb2NoYSh7XG4gIG1vY2hhLCAvLyBJbnN0YW50aWF0ZSBhIE1vY2hhIGluc3RhbmNlLlxuICB0ZXN0VGFyZ2V0LFxuICBqc0ZpbGVBcnJheSxcbiAgc2hvdWxkSW52YWxpZGF0ZVJlcXVpcmVNb2R1bGUgPSBmYWxzZSwgLy8gaW52YWxpZGF0aW9uIGlzbid0IG5lZWRlZCBhbnltb3JlIGFzIHRoaXMgbW9kdWxlIGlzIHJ1biBpbiBhIHN1YnByb2Nlc3NcbiAgc2hvdWxkQ29tcGlsZVRlc3QgPSB0cnVlLFxuICBzaG91bGREZWJ1Z2dlcixcbiAgdGFyZ2V0UHJvamVjdCxcbiAgbW9jaGFPcHRpb24gPSB7fSxcbiAgYWRkaXRpb25hbFBhcmFtZXRlclxufSA9IHt9KSB7XG4gIC8vIHByb2dyYW1tYXRpYyBhcGkgb2YgbW9jaGEgLSBodHRwczovL2dpdGh1Yi5jb20vbW9jaGFqcy9tb2NoYS93aWtpL1VzaW5nLU1vY2hhLXByb2dyYW1tYXRpY2FsbHlcbiAgbW9jaGFPcHRpb24gPSBPYmplY3QuYXNzaWduKFxuICAgIHtcbiAgICAgIHVpOiAndGRkJywgLy8gTm90ZTogbm90IHVzaW5nIGh0dHBzOi8vbW9jaGFqcy5vcmcvI3JlcXVpcmUgaW50ZXJmYWNlIGJlY2F1c2UgaXQgZG9lc24ndCB3b3JrIHdpdGggbm9kZSBjbGksIGl0IHJlcXVpcmVzIHJ1bm5pbmcgdGVzdHMgdGhyb3VnaCBgbW9jaGFgIGNsaSBhcyBtZW50aW9uZWQgaW4gaHR0cHM6Ly9naXRodWIuY29tL21vY2hhanMvbW9jaGEvaXNzdWVzLzExNjBcbiAgICAgIHJlcG9ydGVyOiAncHJvZ3Jlc3MnIHx8ICdtaW4nIC8qbWluIHJlbW92ZXMgYW55IGNvbnNvbGUubG9nIG91dHB1dCBvdXRzaWRlIG9mIHRlc3QvaXQgYmxvY2tzKi8sIC8vIGh0dHBzOi8vbW9jaGFqcy5vcmcvI2xpc3RcbiAgICAgIHRpbWVvdXQ6IDEwMDAwLCAvL21pbGxpc2Vjb25kc1xuICAgICAgZnVsbFRyYWNlOiB0cnVlLFxuICAgICAgLy8gcmV0cmllczogMyAvLyBudW1iZXIgb2YgcmV0cmllcyBvZiBmYWlsZWQgdGVzdHNcbiAgICAgIC8vIGZvcmNlIGV4aXRcbiAgICB9LFxuICAgIG1vY2hhT3B0aW9uLFxuICApXG4gIC8vIHByZXZlbnQgdGVzdCB0aW1lb3V0IGVycm9yIHRyaWdnZXJpbmcgd2hlbiBpbiBkZWJ1ZyBtb2RlIChhcyBwYXVzaW5nIHNjcmlwdCBjb3VudHMgaW4gdGhlIHRpbWVvdXQpLlxuICBpZiAoc2hvdWxkRGVidWdnZXIpIG1vY2hhT3B0aW9uLnRpbWVvdXQgPSBJbmZpbml0eSAvLyBodHRwczovL2dpdGh1Yi5jb20vbW9jaGFqcy9tb2NoYS9ibG9iLzE4NmNhMzY1N2I0ZDNlMGMwYTYwMmE1MDA2NTNhNjk1ZjRlMDg5MzAvbGliL3J1bm5hYmxlLmpzI0wzNlxuICBtb2NoYSB8fD0gbmV3IE1vY2hhKG1vY2hhT3B0aW9uKVxuXG4gIGlmIChzaG91bGRJbnZhbGlkYXRlUmVxdWlyZU1vZHVsZSkge1xuICAgIGNvbnN0IHsgaW52YWxpZGF0ZVJlcXVpcmVkTW9kdWxlLCBpbnZhbGlkYXRlUmVxdWlyZWRNb2R1bGVFdmVudEhhbmRsZXIgfSA9ICcuLi91dGlsaXR5L2ludmFsaWRhdGVSZXF1aXJlZE1vZHVsZS5qcydcbiAgICBpbnZhbGlkYXRlUmVxdWlyZWRNb2R1bGVFdmVudEhhbmRsZXIoeyBtb2NoYUluc3RhbmNlOiBtb2NoYSB9KVxuICAgIGludmFsaWRhdGVSZXF1aXJlZE1vZHVsZSh7IGZpbGVBcnJheToganNGaWxlQXJyYXkgfSlcbiAgfVxuXG4gIGlmIChzaG91bGRDb21waWxlVGVzdCkge1xuICAgIGxldCBjb21waWxlciA9IG5ldyBDb21waWxlcih7IGJhYmVsQ29uZmlnOiB0YXJnZXRQcm9qZWN0LmNvbmZpZ3VyYXRpb24uZ2V0VHJhbnNwaWxhdGlvbigpLmJhYmVsQ29uZmlnIC8qKiBTZWFyY2ggZm9yIGNvbmZpZ3VyYXRpb24gZmlsZXMgZnJvbSB0YXJnZXQgcHJvamVjdCAqLyB9KVxuICAgIGNvbXBpbGVyLnJlcXVpcmVIb29rKHsgcmVzdHJpY3RUb1RhcmdldFByb2plY3Q6IGZhbHNlIC8qIFRyYW5zcGlsZSB0ZXN0cyBvZiB0aGUgdGFyZ2V0IHByb2plY3QgKi8gfSlcbiAgICAvLyBwcm9jZXNzLm9uKCdleGl0JywgKCkgPT4ge1xuICAgIC8vICAgY29uc29sZS5sb2coJ1Rlc3RSdW5uZXIgQ0xJJylcbiAgICAvLyAgIGNvbnNvbGUubG9nKGNvbXBpbGVyLmxvYWRlZEZpbGVzLm1hcCh2YWx1ZSA9PiB2YWx1ZS5maWxlbmFtZSkpXG4gICAgLy8gICBjb25zb2xlLmxvZyhjb21waWxlci5jb25maWcuaWdub3JlKVxuICAgIC8vIH0pXG4gIH1cblxuICAvLyBBZGQgZWFjaCAudGVzdC5qcyBmaWxlIHRvIHRoZSBtb2NoYSBpbnN0YW5jZVxuICBpZiAoQXJyYXkuaXNBcnJheSh0ZXN0VGFyZ2V0KSkge1xuICAgIC8vIHRyZWF0IHRlc3QgdGFyZ2V0IGFzIGFycmF5IG9mIGZpbGVzLlxuICAgIHRlc3RUYXJnZXQuZm9yRWFjaChmaWxlID0+IHtcbiAgICAgIG1vY2hhLmFkZEZpbGUoZmlsZSlcbiAgICB9KVxuICB9IGVsc2Uge1xuICAgIC8vIHNpbmdsZSB0ZXN0IGZpbGUgcGF0aFxuICAgIG1vY2hhLmFkZEZpbGUodGVzdFBhdGgpXG4gIH1cblxuICAvLyBzdHJpbmdpZnkgYWRkaXRpb25hbCBwYXJhbWV0ZXJzIHRvIGJlIHBhc3NlZCB0byB0ZXN0IGZpbGVzLCBhcyBNb2NoYS5ydW4gZG9lc24ndCBzdXBwb3J0IHBhc3NpbmcgcGFyYW1ldGVycyB0byB0aGUgZmlsZXMuXG4gIGlmIChhZGRpdGlvbmFsUGFyYW1ldGVyKVxuICAgIGdsb2JhbC5hZGRpdGlvbmFsUGFyYW1ldGVyID0gSlNPTi5zdHJpbmdpZnkoYWRkaXRpb25hbFBhcmFtZXRlcilcbiAgXG5cbiAgLy8gUnVuIHRlc3RzLlxuICB0cnkge1xuICAgIGlmIChzaG91bGREZWJ1Z2dlcikge1xuICAgICAgc3VicHJvY2Vzc0luc3BlY3RvcigpXG4gICAgICAvLyBkZWJ1Z2dlciAvLyBXaGVuIHVzaW5nIHJ1bnRpbWUgaW5zcGVjdG9yIEFQSSwgdGhlIGJyZWFrcG9pbnRzIGluIFZTQ29kZSB3b24ndCBiZSByZWNvZ25pemVkIHdpdGhvdXQgYnJlYWtpbmcgKFVwZGF0ZWQgLSB0aGlzIGlzIG5vIGxvbmdlciB0cnVlLCBhcyBWU0NvZGUgbGF0ZXN0IHJlbGVhc2Ugc2VlbXMgdG8gZml4IHRoaXMgaXNzdWUpLlxuICAgIH1cbiAgICBtb2NoYS5ydW4oZXJyb3IgPT4ge1xuICAgICAgLy8gZXhpdCB3aXRoIG5vbi16ZXJvIHN0YXR1cyBpZiB0aGVyZSB3ZXJlIGZhaWx1cmVzXG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgLy8gbW9jaGEgaGFuZGxlcyBwcmludGluZyBlcnJvciBtZXNzYWdlLlxuICAgICAgICAvLyB0aHJvdyBlcnJvclxuICAgICAgfVxuICAgICAgLy8gcHJvY2Vzcy5leGl0KClcbiAgICB9KVxuICAgIC8vIC5vbigndGVzdCcsIGZ1bmN0aW9uKHRlc3QpIHtcbiAgICAvLyAgICAgY29uc29sZS5sb2coJ1Rlc3Qgc3RhcnRlZDogJyt0ZXN0LnRpdGxlKTtcbiAgICAvLyB9KVxuICAgIC8vIC5vbigndGVzdCBlbmQnLCBmdW5jdGlvbih0ZXN0KSB7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKCdUZXN0IGRvbmU6ICcrdGVzdC50aXRsZSk7XG4gICAgLy8gfSlcbiAgICAvLyAub24oJ3Bhc3MnLCBmdW5jdGlvbih0ZXN0KSB7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKCdUZXN0IHBhc3NlZCcpO1xuICAgIC8vICAgICBjb25zb2xlLmxvZyh0ZXN0KTtcbiAgICAvLyB9KVxuICAgIC8vIC5vbignZmFpbCcsIGZ1bmN0aW9uKHRlc3QsIGVycikge1xuICAgIC8vICAgICBjb25zb2xlLmxvZygnVGVzdCBmYWlsJyk7XG4gICAgLy8gICAgIGNvbnNvbGUubG9nKHRlc3QpO1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhlcnIpO1xuICAgIC8vIH0pXG4gICAgLy8gLm9uKCdlbmQnLCBmdW5jdGlvbigpIHtcbiAgICAvLyAgICAgY29uc29sZS5sb2coJ0FsbCBkb25lJyk7XG4gICAgLy8gfSlcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmdyb3VwKGDimqAgRXJyb3Igd2hpbGUgcnVubmluZyBNb2NoYSB0ZXN0OmApXG4gICAgY29uc29sZS5sb2coZXJyb3IpXG4gICAgY29uc29sZS5ncm91cEVuZCgpXG4gICAgY29uc29sZS5sb2coJ1xcbicpXG4gICAgLy8gdGhyb3cgZXJyb3JcbiAgfVxufVxuIl19